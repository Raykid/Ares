(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else if(typeof exports==="object")exports["ares_pixijs"]=factory();else root["ares_pixijs"]=factory()})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.i=function(value){return value};__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=2)}([function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function createEvalFunc(exp){var func;try{func=Function("scope","with(scope){return "+exp+"}")}catch(err){var sepStr=exp.indexOf('"')<0?'"':"'";var reg=/([^\\]?)`/g;exp=exp.replace(reg,"$1"+sepStr);reg=/\$\{(.*?)\}/g;exp=exp.replace(reg,sepStr+"+($1)+"+sepStr);func=Function("scope","with(scope){return "+exp+"}")}return func}exports.createEvalFunc=createEvalFunc;function evalExp(exp,scope){return createEvalFunc(exp)(scope)}exports.evalExp=evalExp;function createRunFunc(exp){return createEvalFunc("(function(){"+exp+"})()")}exports.createRunFunc=createRunFunc;function runExp(exp,scope){createRunFunc(exp)(scope)}exports.runExp=runExp},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var PIXICommands_1=__webpack_require__(5);var _tplDict={};function getTemplate(name){return _tplDict[name]}exports.getTemplate=getTemplate;function setTemplate(name,tpl){if(!name||!tpl)return null;if(_tplDict[name])return null;_tplDict[name]=tpl;return tpl}exports.setTemplate=setTemplate;var PIXICompiler=function(){function PIXICompiler(root,config,tplDict){this._nameDict={};this._root=root;this._config=config;this._tplDict=tplDict||{}}Object.defineProperty(PIXICompiler.prototype,"root",{get:function(){return this._root},enumerable:true,configurable:true});PIXICompiler.prototype.parseCmd=function(node){var keys=[];for(var t in node){if(t.indexOf("a-")==0||t.indexOf("a_")==0){keys.push(t)}}var conf=this._config&&this._config[node.name];for(var t in conf){if(t.indexOf("a-")!=0&&t.indexOf("a_")!=0)t="a-"+t;keys.push(t)}var cmdNameDict={};for(var i=0,len=keys.length;i<len;i++){var key=keys[i];var bIndex=2;var eIndex=key.indexOf(":");if(eIndex<0)eIndex=key.indexOf("$");if(eIndex<0)eIndex=key.length;var cmdName=key.substring(bIndex,eIndex);var exp;if(conf)exp=conf[key]||conf[cmdName]||node[key];else exp=node[key];var subCmd=key.substr(eIndex+1);cmdNameDict[cmdName]={cmdName:cmdName,subCmd:subCmd,propName:key,exp:exp}}return cmdNameDict};PIXICompiler.prototype.parseTpl=function(node){var tplName=node["a-tplName"]||node["a_tplName"];if(tplName){var callback=function(){delete node["a-tplName"];delete node["a_tplName"];delete node["a-tplGlobal"];delete node["a_tplGlobal"];node.parent&&node.parent.removeChild(node)};if(node["a-tplGlobal"]=="true"||node["a_tplGlobal"]=="true"){if(setTemplate(tplName,node)){callback();return true}}else{if(this.setTemplate(tplName,node)){callback();return true}}}return false};PIXICompiler.prototype.init=function(entity){this._entity=entity;this.compile(this._root,entity.data)};PIXICompiler.prototype.compile=function(node,scope){if(this.parseTpl(node))return;var hasLazyCompile=false;var name=node.name;if(name)this._nameDict[name]=node;var cmdDict=this.parseCmd(node);var cmdsToCompile=[];for(var cmdName in cmdDict){var cmdData=cmdDict[cmdName];var subCmd=cmdData.subCmd;var exp=cmdData.exp;var cmd=PIXICommands_1.commands[cmdName];if(!cmd){cmd=PIXICommands_1.commands["prop"];subCmd=cmdName||""}var cmdToCompile={propName:cmdData.propName,cmd:cmd,ctx:{scope:scope,target:node,subCmd:subCmd,exp:exp,compiler:this,entity:this._entity}};if(cmdName=="tpl")cmdsToCompile.unshift(cmdToCompile);else cmdsToCompile.push(cmdToCompile);if(cmdName=="if"||cmdName=="for"){hasLazyCompile=true;cmdsToCompile.splice(0,cmdsToCompile.length-1);break}}for(var i=0,len=cmdsToCompile.length;i<len;i++){var cmdToCompile=cmdsToCompile[i];cmdToCompile.ctx.target=node;delete cmdToCompile.ctx.target[cmdToCompile.propName];node=cmdToCompile.cmd(cmdToCompile.ctx)}if(!hasLazyCompile){if(node instanceof PIXI.Text){this.compileTextContent(node,scope)}if(node instanceof PIXI.Container){var children=node.children;var nextChild;for(var i=0,len=children.length;i<len;i++){var child=children[i];nextChild=children[i+1];this.compile(child,scope);var nextI=children.indexOf(nextChild);if(nextI>=0&&nextI!=i+1){i=nextI-1;len=children.length}}}}};PIXICompiler.prototype.getTemplate=function(name){return this._tplDict[name]};PIXICompiler.prototype.setTemplate=function(name,tpl){if(!name||!tpl)return null;if(this._tplDict[name])return null;this._tplDict[name]=tpl;return tpl};PIXICompiler.prototype.compileTextContent=function(text,scope){var value=text.text;if(PIXICompiler._textExpReg.test(value)){var exp=this.parseTextExp(value);PIXICommands_1.textContent({scope:scope,target:text,subCmd:"",exp:exp,compiler:this,entity:this._entity})}};PIXICompiler.prototype.parseTextExp=function(exp){var reg=PIXICompiler._textExpReg;for(var result=reg.exec(exp);result!=null;result=reg.exec(exp)){exp=result[1]+"${"+result[2]+"}"+result[3]}return"`"+exp+"`"};return PIXICompiler}();PIXICompiler._textExpReg=/(.*?)\{\{(.*?)\}\}(.*)/;exports.PIXICompiler=PIXICompiler},,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var PIXICompiler_1=__webpack_require__(2);var Utils_1=__webpack_require__(0);function addCommand(name,command){if(!exports.commands[name])exports.commands[name]=command}exports.addCommand=addCommand;function textContent(context){context.entity.createWatcher(context.target,context.exp,context.scope,function(value){var text=context.target;text.text=value})}exports.textContent=textContent;exports.commands={tpl:function(context){var template=context.compiler.getTemplate(context.exp);if(!template)template=PIXICompiler_1.getTemplate(context.exp);if(!template)return context.target;template=cloneObject(template,true);var target=context.target;var parent=target.parent;parent.addChildAt(template,parent.getChildIndex(target));parent.removeChild(target);target.destroy();context.compiler.compile(template,context.scope);return template},prop:function(context){var target=context.target;context.entity.createWatcher(context.target,context.exp,context.scope,function(value){if(context.subCmd!=""){target[context.subCmd]=value}else{for(var name in value){target[name]=value[name]}}});return target},on:function(context){if(context.subCmd!=""){var handler=context.scope[context.exp]||window[context.exp];if(typeof handler=="function"){context.target.on(context.subCmd,handler,context.scope)}else{context.target.on(context.subCmd,function(evt){var scope=Object.create(context.scope);scope.$event=evt;scope.$target=context.target;Utils_1.runExp(context.exp,scope)})}}return context.target},"if":function(context){var compiled=false;var refNode=new PIXI.Container;refNode.interactive=refNode.interactiveChildren=false;var parent=context.target.parent;var index=parent.getChildIndex(context.target);parent.addChildAt(refNode,index);var watcher=context.entity.createWatcher(context.target,context.exp,context.scope,function(value){if(!refNode.parent){watcher.dispose();return}if(value==true){if(!compiled){context.compiler.compile(context.target,context.scope);compiled=true}if(!context.target.parent){var index=refNode.parent.getChildIndex(refNode);refNode.parent.addChildAt(context.target,index)}}else{if(context.target.parent){context.target.parent.removeChild(context.target)}}});return context.target},"for":function(context){var reg=/^\s*(\S+)\s+in\s+(\S+)\s*$/;var res=reg.exec(context.exp);if(!res){console.error("for命令表达式错误："+context.exp);return}var itemName=res[1];var arrName=res[2];var parent=context.target.parent;var sNode=new PIXI.Container;sNode.interactive=sNode.interactiveChildren=false;var eNode=new PIXI.Container;eNode.interactive=eNode.interactiveChildren=false;var index=parent.getChildIndex(context.target);parent.addChildAt(sNode,index);parent.addChildAt(eNode,index+1);parent.removeChild(context.target);var watcher=context.entity.createWatcher(context.target,arrName,context.scope,function(value){if(!sNode.parent){watcher.dispose();return}var bIndex=parent.getChildIndex(sNode);var eIndex=parent.getChildIndex(eNode);for(var i=eIndex-1;i>bIndex;i--){parent.removeChildAt(i).destroy()}if(typeof value=="number"){var temp=[];for(var i=0;i<value;i++){temp.push(i)}value=temp}var curIndex=0;for(var key in value){var newNode=cloneObject(context.target,true);parent.addChildAt(newNode,bIndex+1+curIndex);var newScope=Object.create(context.scope);Object.defineProperty(newScope,"$index",{configurable:true,enumerable:false,value:value instanceof Array?parseInt(key):key,writable:false});Object.defineProperty(newScope,itemName,{configurable:true,enumerable:true,value:value[key],writable:false});context.compiler.compile(newNode,newScope);curIndex++}});return context.target}};function cloneObject(target,deep){var result;if(!target||typeof target!="object")return target;if(target instanceof PIXI.ObservablePoint){return new PIXI.ObservablePoint(target["cb"],target["scope"]["__ares_cloning__"],target["x"],target["y"])}if(typeof target["clone"]=="function")return target["clone"]();if(!deep){result=Object.create(target["__proto__"]||null);for(var k in target){result[k]=target[k]}return result}var cls=target.constructor||Object;try{result=new cls}catch(err){return null}target["__ares_cloning__"]=result;for(var key in target){if(key=="__ares_cloning__")continue;if(typeof target[key]=="function"&&!target.hasOwnProperty(key))continue;if(key=="_texture"&&target instanceof PIXI.Text)continue;if(key=="parent"&&target instanceof PIXI.DisplayObject){if(target["parent"]&&target["parent"]["__ares_cloning__"]){result["parent"]=target["parent"]["__ares_cloning__"]}else{result["parent"]=target["parent"]}continue}if(key=="_events"&&target instanceof PIXI.utils.EventEmitter){result["_events"]=cloneObject(target["_events"],false);for(var k in target["_events"]){var temp=target["_events"][k];if(temp.context==target){result["_events"][k].context=result}}continue}if(key=="children"&&target instanceof PIXI.Container){var children=target["children"];for(var j in children){var child=cloneObject(children[j],true);result["addChild"](child)}continue}if(key=="vertexData"&&target instanceof PIXI.Sprite){result[key]=target[key]["slice"]();continue}var oriValue=target[key];if(oriValue&&oriValue["__ares_cloning__"]){result[key]=oriValue["__ares_cloning__"]}else{var value=cloneObject(oriValue,true);if(value!=null){try{result[key]=value}catch(err){}}}}delete target["__ares_cloning__"];return result}}])});