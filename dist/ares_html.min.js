(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else if(typeof exports==="object")exports["ares_html"]=factory();else root["ares_html"]=factory()})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.i=function(value){return value};__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=9)}({0:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function createEvalFunc(exp){var func;try{func=Function("scope","with(scope){return "+exp+"}")}catch(err){var sepStr=exp.indexOf('"')<0?'"':"'";var reg=/([^\\]?)`/g;exp=exp.replace(reg,"$1"+sepStr);reg=/\$\{(.*?)\}/g;exp=exp.replace(reg,sepStr+"+($1)+"+sepStr);func=Function("scope","with(scope){return "+exp+"}")}return func}exports.createEvalFunc=createEvalFunc;function evalExp(exp,scope){return createEvalFunc(exp)(scope)}exports.evalExp=evalExp;function createRunFunc(exp){return createEvalFunc("(function(){"+exp+"})()")}exports.createRunFunc=createRunFunc;function runExp(exp,scope){createRunFunc(exp)(scope)}exports.runExp=runExp},4:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utils_1=__webpack_require__(0);function addCommand(name,command){if(!exports.commands[name])exports.commands[name]=command}exports.addCommand=addCommand;function textContent(context){context.entity.createWatcher(context.target,context.cmdData.exp,context.scope,function(value){context.target.nodeValue=value})}exports.textContent=textContent;exports.commands={text:function(context){context.entity.createWatcher(context.target,context.cmdData.exp,context.scope,function(value){context.target.textContent=value})},html:function(context){context.entity.createWatcher(context.target,context.cmdData.exp,context.scope,function(value){var target=context.target;target.innerHTML=value;var children=target.childNodes;for(var i=0,len=children.length;i<len;i++){context.compiler.compile(children[i],context.scope)}})},css:function(context){var target=context.target;var oriCls=target.getAttribute("class");context.entity.createWatcher(context.target,context.cmdData.exp,context.scope,function(params){if(typeof params=="string"){if(oriCls)params=oriCls+" "+params;target.setAttribute("class",params)}else{var arr=[];if(oriCls)arr.push(oriCls);for(var cls in params){if(params[cls]==true)arr.push(cls)}if(arr.length>0)target.setAttribute("class",arr.join(" "))}})},attr:function(context){var cmdData=context.cmdData;var target=context.target;context.entity.createWatcher(context.target,cmdData.exp,context.scope,function(value){if(cmdData.subCmd!=""){target.setAttribute(cmdData.subCmd,value)}else{for(var name in value){var value=value[name];target.setAttribute(name,value)}}})},on:function(context){var cmdData=context.cmdData;if(cmdData.subCmd!=""){var handler=context.scope[cmdData.exp]||window[context.cmdData.exp];if(typeof handler=="function"){context.target.addEventListener(cmdData.subCmd,handler.bind(context.scope))}else{context.target.addEventListener(cmdData.subCmd,function(evt){var scope=Object.create(context.scope);scope.$event=evt;scope.$target=context.target;Utils_1.runExp(cmdData.exp,scope)})}}},"if":function(context){var compiled=false;var refNode=document.createTextNode("");context.target.parentNode.insertBefore(refNode,context.target);context.entity.createWatcher(context.target,context.cmdData.exp,context.scope,function(value){if(value==true){if(!compiled){context.compiler.compile(context.target,context.scope);compiled=true}if(!context.target.parentNode){refNode.parentNode.insertBefore(context.target,refNode)}}else{if(context.target.parentNode){context.target.parentNode.removeChild(context.target)}}})},"for":function(context){var cmdData=context.cmdData;var reg=/^\s*(\S+)\s+in\s+(\S+)\s*$/;var res=reg.exec(cmdData.exp);if(!res){console.error("for命令表达式错误："+cmdData.exp);return}var itemName=res[1];var arrName=res[2];var pNode=context.target.parentNode;var sNode=document.createTextNode("");var eNode=document.createTextNode("");var range=document.createRange();pNode.replaceChild(eNode,context.target);pNode.insertBefore(sNode,eNode);context.entity.createWatcher(context.target,arrName,context.scope,function(value){range.setStart(sNode,0);range.setEnd(eNode,0);range.deleteContents();if(typeof value=="number"){var temp=[];for(var i=0;i<value;i++){temp.push(i)}value=temp}for(var key in value){var newNode=context.target.cloneNode(true);pNode.insertBefore(newNode,eNode);var newScope=Object.create(context.scope);Object.defineProperty(newScope,"$index",{configurable:true,enumerable:false,value:value instanceof Array?parseInt(key):key,writable:false});Object.defineProperty(newScope,itemName,{configurable:true,enumerable:true,value:value[key],writable:false});context.compiler.compile(newNode,newScope)}})}}},9:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var HTMLCommands_1=__webpack_require__(4);var HTMLCompiler=function(){function HTMLCompiler(selectorsOrElement){this._selectorsOrElement=selectorsOrElement}Object.defineProperty(HTMLCompiler.prototype,"root",{get:function(){return this._root},enumerable:true,configurable:true});HTMLCompiler.prototype.init=function(entity){if(typeof this._selectorsOrElement=="string")this._root=document.querySelector(this._selectorsOrElement);else this._root=this._selectorsOrElement;this._entity=entity;this.compile(this._root,entity.data)};HTMLCompiler.prototype.compile=function(node,scope){var cmdDict={};if(node.nodeType==3){this.compileTextContent(node,scope,cmdDict)}else{var hasLazyCompile=false;var attrs=node.attributes;var cmdsToCompile=[];for(var i=0,len=attrs.length;i<len;i++){var attr=attrs[i];var name=attr.name;var result=HTMLCompiler._cmdRegExp.exec(name);if(result){var cmdName=result[2];var cmd=HTMLCommands_1.commands[cmdName];if(cmd){var cmdData={cmdName:cmdName,subCmd:result[4],propName:result[0],exp:attr.value};cmdsToCompile.push({attr:attr,cmd:cmd,ctx:{scope:scope,target:node,compiler:this,entity:this._entity,cmdData:cmdData,cmdDict:cmdDict}});if(cmdName=="if"||cmdName=="for"){hasLazyCompile=true;cmdsToCompile.splice(0,cmdsToCompile.length-1);break}}}}for(var i=0,len=cmdsToCompile.length;i<len;i++){var cmdToCompile=cmdsToCompile[i];cmdToCompile.attr.ownerElement.removeAttribute(cmdToCompile.attr.name);cmdToCompile.cmd(cmdToCompile.ctx)}if(!hasLazyCompile){var children=node.childNodes;for(var i=0,len=children.length;i<len;i++){var child=children[i];this.compile(child,scope)}}}};HTMLCompiler.prototype.compileTextContent=function(node,scope,cmdDict){if(HTMLCompiler._textRegExp.test(node.nodeValue)){var exp=this.parseTextExp(node.nodeValue);HTMLCommands_1.textContent({scope:scope,target:node,compiler:this,entity:this._entity,cmdData:{cmdName:"",subCmd:"",propName:"",exp:exp},cmdDict:cmdDict})}};HTMLCompiler.prototype.parseTextExp=function(exp){var reg=HTMLCompiler._textRegExp;for(var result=reg.exec(exp);result!=null;result=reg.exec(exp)){exp=result[1]+"${"+result[2]+"}"+result[3]}return"`"+exp+"`"};return HTMLCompiler}();HTMLCompiler._cmdRegExp=/^(data\-)?a\-(\w+)(:(.+))?$/;HTMLCompiler._textRegExp=/(.*?)\{\{(.*?)\}\}(.*)/;exports.HTMLCompiler=HTMLCompiler}})});